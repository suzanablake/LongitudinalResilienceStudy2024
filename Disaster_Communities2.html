<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SB">

<title>Shrimp Analysis - March 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Disaster_Communities2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Disaster_Communities2_files/libs/quarto-html/quarto.js"></script>
<script src="Disaster_Communities2_files/libs/quarto-html/popper.min.js"></script>
<script src="Disaster_Communities2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Disaster_Communities2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Disaster_Communities2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Disaster_Communities2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Disaster_Communities2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Disaster_Communities2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Disaster_Communities2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Shrimp Analysis - March 2024</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Suzana Blake </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the GI data - with inflation adjusted values</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>GI <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Resilience/GitReady/UpdatedData/GI.RData"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display a summary of the GI data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  landed_year   data_supplier_st    dealer_id         corporate_name    
 Min.   :1977   Length:475823      Length:475823      Length:475823     
 1st Qu.:1993   Class :character   Class :character   Class :character  
 Median :2002   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2001                                                           
 3rd Qu.:2011                                                           
 Max.   :2020                                                           
                                                                        
 dealer_state       county_name        dealer_city          zipcode         
 Length:475823      Length:475823      Length:475823      Length:475823     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  species_itis    common_name           live_lbs             value         
 Min.   :  5414   Length:475823      Min.   :      -10   Min.   :    -190  
 1st Qu.:161092   Class :character   1st Qu.:       41   1st Qu.:      53  
 Median :168791   Mode  :character   Median :      322   Median :     401  
 Mean   :192794                      Mean   :    96661   Mean   :   66539  
 3rd Qu.:170335                      3rd Qu.:     3380   3rd Qu.:    4386  
 Max.   :775091                      Max.   :602540946   Max.   :78082845  
 NA's   :9                           NA's   :997         NA's   :20353     
 Inflation_index  Adjust_factor    Adjusted_Val     
 Min.   : 33.43   Min.   :1.000   Min.   :    -207  
 1st Qu.: 68.88   1st Qu.:1.159   1st Qu.:      74  
 Median : 81.03   Median :1.404   Median :     563  
 Mean   : 81.87   Mean   :1.482   Mean   :  103924  
 3rd Qu.: 98.16   3rd Qu.:1.652   3rd Qu.:    6195  
 Max.   :113.78   Max.   :3.404   Max.   :80520745  
                                  NA's   :20353     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>com_names<span class="ot">&lt;-</span><span class="fu">unique</span>(GI<span class="sc">$</span>common_name)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>(com_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 826 139 842  42 112 344 837 156 691 374 170 171 227 493 169 196 220 219
 [19] 217  82 450 711 652 808 291  77 833 591 328  81 330 348  51 694 259 258
 [37] 212 497 256 416 633 728 653 597 605 600 251 206 218 261 700 745 607 613
 [55] 571 425 570 396 394 625 199 225 314 324 395 631  14 274  67 548 322 797
 [73] 486 386 242 455 671 676   1 668 376 537 551 148 667 279 590 155 264 287
 [91] 195 638 265 263 262 422 368 547 500 552 568 167 522 523 526 560 544 698
[109]  46  12 658 138 593 216 383 844 221 389 446 230 802 781 798 375  83 741
[127] 108 803 851 799 249  15 656 100 293 406 335 510 281 432 449 137 255 562
[145] 326 683 774 674 578 640 168 451 366 305 204 708 410 358 655 172  99   8
[163] 650 577 385 236 442  57 237 331 575 784 776 785 751 804 760 176 520 794
[181] 239 805 787 664 598 496 238 235 114 181 337 619 858 762 813 507 754 554
[199] 622 823 675 468 721 452 341  25 725 704 443 779 187 836 789 608 603 140
[217] 131 490 822 308 426 288 390 223 222 266 353 309 828 202 680 615 470 761
[235] 614 651 113  63 361 684 535  26 806 473  27 306 583 290  93 555 637 769
[253] 824 800 792 245 635 665 632 106 318 252 768 649 647 467 360 180 175 397
[271] 207 611 315 226 636  10 453  47 812 545 192  31 764 524 355 347 429 763
[289] 103 439 722 731 250 687 796 550 860 572 525 539 540 529 152 343 695 610
[307] 830 602 200 277 685 772 352  52 556 294 302 111 709 107 532 458 434 132
[325] 110 533 120 536 436  60 109 115 356  13 744 714 214 746  54 738 669 549
[343] 516 454 145 693 357 191 673 336 780 350 104  85 270 662 663 283 777 666
[361] 179 506  75 349 136  88 194 301 300 158 697  62 271 224 508 415 431 501
[379] 645  16 466 475 215 121 313 321 312 834 276 418 852 795 853 644 624  36
[397] 528 818  50 604 701 707 672 682 703 387 581 850 157  59 133 716 469  40
[415] 129 617 811 154  49  34  30 586 706 267 629 461 710  92  96  98 447 465
[433] 119  11 472 471 686 681  71 715  33 339 247 211 246  28  45 584 849 620
[451] 659 428 174 727  72 232 408 407 231 739 151 509 621 208   6 513 661 660
[469] 564 289 369 400 424 423 370 393 275 198 832 705 438 712 126 729 730 574
[487]  53  55 601 153 720   3 188 634 759 165 163 164 576 498 788 378 801 448
[505] 334 845 519 515 327  18 481 588 654  35 505 488 480 592 503 462 514 193
[523] 530 273 205 411 373 807 372 732 726 587 365 128 692 399 311 724 717 269
[541] 409 304 825 609 699 320 831 518 558 569 345 538 460  17 459 144 626 478
[559] 333 213 292  69 285 521 130  70 384  37  44 296 790 101 420 531 254 456
[577] 553 340 457 105 477 401 377 363 190 189 367 618  22 122  21 757 765 783
[595] 791 702 127 485 854 512   9 596 495 504 464 146 563 412 143 565 403 476
[613] 623 402 627 582 491 210 589 150 149 599 209 843 566 404 771 829 585 474
[631] 430 678 857 841 511 856 142 689 159 567 743 317 839 342  20 134 527   4
[649] 125 178 234 642 670 362 316 657 233 177  41  97   5 298 561 559 742 775
[667]  95 767 338 755 810 723 546 297 840 838 748 382 483 859 484 379 494 441
[685] 359 229 499 435 135 421 413 414 380 770 282 580 713  74 749 847 848 809
[703] 846 835 747 778 752 782 793 773 733 734 735 815 736 737 817 346 161 479
[721] 160 325 303  43  65 437  64 162  19 117  48  66 102 740 260 299 758 534
[739] 307  94 118  84  79 166  80  78 147 766 141  23 677 679   7  39 643 286
[757] 253 492 240 183 284 241 606 182 440 371 612 639 616 573 280 244 756  58
[775] 648 268 201 329 444  68 203 641 628 482  61  32 487 594 116 690 405 388
[793] 517 248 753 827 821 257 351 323 816 814 463 579 278  56  73 445 332 417
[811] 398 173  86 696  91  87  89 688 124  90 364  29 228 595 542 646 820 819
[829] 718 557 719 543 855 541 489 185 750 243 354 186 184 319 786  38  76 630
[847] 123 419 433 381   2 502  24 295 392 391 272 197 310 427</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(com_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
  [1] "Brown Shrimp"                           
  [2] "White Shrimp"                           
  [3] "Pink Shrimp"                            
  [4] "SHRIMP, ATLANIC SEABOB"                 
  [5] "SHRIMP, ROYAL RED"                      
  [6] "OYSTER, EASTERN"                        
  [7] "SQUIDS"                                 
  [8] "CRAB, BLUE"                             
  [9] "SHARK"                                  
 [10] "FISHES, BONY"                           
 [11] "MENHADENS"                              
 [12] "CATFISHES, SEA"                         
 [13] "GROUPERS"                               
 [14] "BLUEFISH"                               
 [15] "COBIA"                                  
 [16] "JACK, CREVALLE"                         
 [17] "RUNNER, BLUE"                           
 [18] "POMPANO, FLORIDA"                       
 [19] "SNAPPER, RED"                           
 [20] "SHEEPSHEAD"                             
 [21] "SEATROUT, SPOTTED"                      
 [22] "SEATROUT, SAND"                         
 [23] "SPOT"                                   
 [24] "WHITING, KING"                          
 [25] "CROAKER, ATLANTIC"                      
 [26] "DRUM, BLACK"                            
 [27] "DRUM, RED"                              
 [28] "MULLET, STRIPED"                        
 [29] "TUNNY, LITTLE"                          
 [30] "MACKEREL, SPANISH"                      
 [31] "FLATFISH"                               
 [32] "TILEFISH"                               
 [33] "MOONFISH, ATLANTIC"                     
 [34] "MACKEREL, KING AND CERO"                
 [35] "PORGIES"                                
 [36] "KINGFISH, SOUTHERN"                     
 [37] "SCALLOP, ATLANTIC CALICO"               
 [38] "VENUS, SUNRAY"                          
 [39] "SQUIDS, LOLIGINIDAE"                    
 [40] "LOBSTERS, SLIPPER"                      
 [41] "SHRIMP, ROCK"                           
 [42] "AMBERJACK"                              
 [43] "SNAPPER, GRAY"                          
 [44] "SCALLOP, BAY"                           
 [45] "MULLET, WHITE"                          
 [46] "CATFISHES, FORKTAIL"                    
 [47] "FISHES, GOAT"                           
 [48] "SNAPPER, VERMILION"                     
 [49] "MACKEREL, KING"                         
 [50] "LADYFISH"                               
 [51] "BASS, BLACK SEA"                        
 [52] "GOLIATH GROUPER"                        
 [53] "PERMIT"                                 
 [54] "GRUNTS"                                 
 [55] "PIGFISH"                                
 [56] "TRIGGERFISHES"                          
 [57] "CRAB, FLORIDA STONE"                    
 [58] "STURGEONS"                              
 [59] "LOBSTER, CARIBBEAN SPINY"               
 [60] "GROUPER, WARSAW"                        
 [61] "TILAPIAS"                               
 [62] "HOGFISH"                                
 [63] "DOLPHINFISH"                            
 [64] "SNAPPER, MUTTON"                        
 [65] "SNAPPER, LANE"                          
 [66] "SNAPPER, YELLOWTAIL"                    
 [67] "BONITO, ATLANTIC"                       
 [68] "SWORDFISH"                              
 [69] "SARDINE, SPANISH"                       
 [70] "SCADS"                                  
 [71] "MOJARRAS"                               
 [72] "OCTOPUS"                                
 [73] "TRIPLETAIL"                             
 [74] "SNAILS (CONCH)"                         
 [75] "HERRING, ATLANTIC THREAD"               
 [76] "WAHOO"                                  
 [77] "BALLYHOO"                               
 [78] "SPONGE, YELLOW"                         
 [79] "SPONGE, GRASS"                          
 [80] "SPONGE, SHEEPSWOOL"                     
 [81] "BARRACUDAS"                             
 [82] "ANGELFISHES"                            
 [83] "CLAM, NORTHERN QUAHOG"                  
 [84] "SPONGE, GLOVE"                          
 [85] "HARVESTFISHES"                          
 [86] "TUNA"                                   
 [87] "TUNA, BLACKFIN"                         
 [88] "HERRINGS, RIVER"                        
 [89] "TUNA, BLUEFIN"                          
 [90] "TUNA, YELLOWFIN"                        
 [91] "TUNA, BIGEYE"                           
 [92] "MARLIN"                                 
 [93] "EEL, AMERICAN"                          
 [94] "SPADEFISHES"                            
 [95] "SHRIMPS, PENAEOID"                      
 [96] "MARLIN, BLUE"                           
 [97] "SHRIMP, ROUGHNECK"                      
 [98] "MARLIN, WHITE"                          
 [99] "CRAB"                                   
[100] "CODLINGS"                               
[101] "SCAMP"                                  
[102] "SNAPPERS"                               
[103] "FLOUNDERS, PARALICHTHYS"                
[104] "HARVESTFISH, NORTHERN"                  
[105] "SEA BASS, MIXED"                        
[106] "EELS"                                   
[107] "GROUPER, GAG"                           
[108] "CLAM, SOUTHERN QUAHOG"                  
[109] "GROUPER, YELLOWEDGE"                    
[110] "GROUPER, RED"                           
[111] "GROUPER, BLACK"                         
[112] "AMBERJACK, GREATER"                     
[113] "DOLPHIN"                                
[114] "CRAB, STONE"                            
[115] "GROUPER, YELLOWFIN"                     
[116] "TILEFISH, BLUELINE"                     
[117] "SNAPPER, SILK"                          
[118] "SPEARFISH, LONGBILL"                    
[119] "MENHADEN, ATLANTIC"                     
[120] "GROUPER, SNOWY"                         
[121] "JACKS"                                  
[122] "SEATROUT, SILVER"                       
[123] "WEAKFISH"                               
[124] "TUNA, SKIPJACK"                         
[125] "SHRIMP, BAIT"                           
[126] "PERCH, SAND"                            
[127] "SHAD, AMERICAN"                         
[128] "RAYS"                                   
[129] "LOOKDOWN"                               
[130] "SCAD, ROUND"                            
[131] "CUTLASSFISH"                            
[132] "GROUPER, NASSAU"                        
[133] "LOBSTER, SPANISH"                       
[134] "SHELLFISH, OTHER"                       
[135] "SNAIL, OTHER"                           
[136] "HERRINGS"                               
[137] "CONCH, QUEEN"                           
[138] "CERO"                                   
[139] "ALBACORE"                               
[140] "CUSK"                                   
[141] "SPONGES, SHEEPSWOOL"                    
[142] "SHARK, THRESHER"                        
[143] "SHARK, BULL"                            
[144] "SAILFISH"                               
[145] "HAKE, WHITE"                            
[146] "SHARK, BLACKTIP"                        
[147] "SPONGES"                                
[148] "BUMPER, ATLANTIC"                       
[149] "SHARK, MAKO, SHORTFIN"                  
[150] "SHARK, MAKO, LONGFIN"                   
[151] "OILFISH"                                
[152] "GARFISHES"                              
[153] "PINFISH"                                
[154] "MACKEREL, CHUB"                         
[155] "BUTTERFISH, GULF"                       
[156] "ANCHOVIES"                              
[157] "LOBSTER, AMERICAN"                      
[158] "HIND, SPECKLED"                         
[159] "SHARK, TIGER"                           
[160] "SNAPPER, CUBERA"                        
[161] "SNAPPER, BLACKFIN"                      
[162] "SNAPPER, QUEEN"                         
[163] "PLANT, HALIMEDA"                        
[164] "PLANT, MERMAID'S SHAVING BRUSH"         
[165] "PLANT, CAULERPA"                        
[166] "SPONGE, RED BALL"                       
[167] "CASSIOPEA, JAMAICAN"                    
[168] "CORALS"                                 
[169] "ANENONE, GIANT CARIBBEAN"               
[170] "ANEMONE, RINGED"                        
[171] "ANEMONE, SPECKLED"                      
[172] "COWRIE, MEASLED"                        
[173] "TULIP, TRUE"                            
[174] "NUDIBRANCHS"                            
[175] "FILECLAM, SPINY"                        
[176] "CRAB, HORSESHOE"                        
[177] "SHRIMP, PISTOL OR SNAPPING"             
[178] "SHRIMP, BANDED CORAL"                   
[179] "HERMIT, THINSTRIPE"                     
[180] "FILECLAM, ROUGH"                        
[181] "CRAB, YELLOWLINE ARROW"                 
[182] "STAR, SPINY SEA"                        
[183] "STAR, BLACK BRITTLE"                    
[184] "URCHIN, SLATE PENCIL"                   
[185] "URCHIN, GREEN SEA"                      
[186] "URCHIN, ROCK BORING"                    
[187] "CUCUMBER, FLORIDA SEA"                  
[188] "PIPEFISH, SARGASSUM"                    
[189] "SEAHORSE, LINED"                        
[190] "SEAHORSE, DWARF"                        
[191] "HAMLET, BUTTER"                         
[192] "FLAMEFISH"                              
[193] "PORKFISH"                               
[194] "HIGH-HAT"                               
[195] "BUTTERFLYFISH, FOUREYE"                 
[196] "ANGELFISH, BLUE"                        
[197] "WRASSE, OTHER"                          
[198] "PARROTFISHES"                           
[199] "BLENNY, OTHER"                          
[200] "GOBY, NEON"                             
[201] "SURGEON, OCEAN"                         
[202] "DOCTORFISH"                             
[203] "TANG, BLUE"                             
[204] "COWFISH, HONEYCOMB"                     
[205] "PUFFER, SHARPNOSE"                      
[206] "BEAUGREGORY"                            
[207] "FILEFISH, PLANEHEAD"                    
[208] "OYSTER, ATLANTIC THORNY"                
[209] "SHARK, NURSE"                           
[210] "SHARK, LEMON"                           
[211] "MORAY, GREEN"                           
[212] "BASS, LANTERN"                          
[213] "SANDFISH, BELTED"                       
[214] "GRUNT, FRENCH"                          
[215] "JACKKNIFE-FISH"                         
[216] "CHERUBFISH"                             
[217] "ANGELFISH, QUEEN"                       
[218] "BEAUTY, ROCK"                           
[219] "ANGELFISH, GRAY"                        
[220] "ANGELFISH, FRENCH"                      
[221] "CHROMIS, BLUE"                          
[222] "DAMSELFISH, YELLOWTAIL"                 
[223] "DAMSELFISH, THREESPOT"                  
[224] "HOGFISH, SPOTFIN"                       
[225] "BLENNY, REDLIP"                         
[226] "FILEFISH, WHITESPOTTED"                 
[227] "ANEMONE, SUN"                           
[228] "TURBAN, CHESTNUT"                       
[229] "SNAIL, MUREX"                           
[230] "CLAM"                                   
[231] "OCTOPUS, COMMON"                        
[232] "OCTOPUS, ATLANTIC PYGMY"                
[233] "SHRIMP, PEPPERMINT"                     
[234] "SHRIMP, CLEANER"                        
[235] "CRAB, SPOTTED PORCELAIN"                
[236] "CRAB, FALSE ARROW"                      
[237] "CRAB, FURCATE SPIDER"                   
[238] "CRAB, REDFINGER RUBBLE"                 
[239] "CRAB, NIMBLE SPRAY"                     
[240] "STAR, BASKET"                           
[241] "STAR, SCALY BRITTLE"                    
[242] "BRITTLE STAR, SERPENT"                  
[243] "URCHIN, LONG-SPINED SEA"                
[244] "STINGRAYS"                              
[245] "EEL, MORAYS"                            
[246] "MORAY, SPOTTED"                         
[247] "MORAY, GOLDENTAIL"                      
[248] "TOADFISHES"                             
[249] "CLINGFISHES"                            
[250] "FROGFISH, OCELLATED"                    
[251] "BATFISH, OTHER"                         
[252] "EELS, CUSK"                             
[253] "SQUIRRELFISH, REEF"                     
[254] "SCORPIONFISH, REEF"                     
[255] "CONEY"                                  
[256] "BASS, PEPPERMINT"                       
[257] "TOBACCOFISH"                            
[258] "BASS, HARLEQUIN"                        
[259] "BASS, CHALK"                            
[260] "SOAPFISHES"                             
[261] "BIGEYE"                                 
[262] "BUTTERFLYFISH, SPOTFIN"                 
[263] "BUTTERFLYFISH, REEF"                    
[264] "BUTTERFLYFISH, BANDED"                  
[265] "BUTTERFLYFISH, LONGSNOUT"               
[266] "DAMSELFISHES"                           
[267] "MAJOR, SERGEANT"                        
[268] "SUNSHINEFISH"                           
[269] "REEFFISH, PURPLE"                       
[270] "HAWKFISH, REDSPOTTED"                   
[271] "HOGFISH, SPANISH"                       
[272] "WRASSE, CREOLE"                         
[273] "PUDDINGWIFE"                            
[274] "BLUEHEAD"                               
[275] "PARROTFISH, STRIPED"                    
[276] "JAWFISHES, SPOTFIN"                     
[277] "GOBY, OTHER"                            
[278] "TRIGGERFISH, QUEEN"                     
[279] "BURRFISH, STRIPED"                      
[280] "STINGRAY, YELLOW"                       
[281] "CONCH, HORSE"                           
[282] "SNAIL, TURBONELLA"                      
[283] "HERMIT, POLKADOTTED"                    
[284] "STAR, CUSHIONED"                        
[285] "SARGASSUMFISH"                          
[286] "SQUIRRELFISH, DEEPWATER"                
[287] "BUTTERFLYFISH, BANK"                    
[288] "DAMSELFISH, DUSKY"                      
[289] "PARROTFISH, BLUE"                       
[290] "DURGON, BLACK"                          
[291] "BALLOONFISH"                            
[292] "SARDINE, SCALED"                        
[293] "CODONELLOPSIDAE"                        
[294] "GORGONIAN, SEA BLADES"                  
[295] "WORM, MARINE"                           
[296] "SCALLOP, LIONS-PAW"                     
[297] "SLUG, LETTUCE"                          
[298] "SHRIMP, SPOTTED CLEANER"                
[299] "SOLDIERFISH, BLACKBAR"                  
[300] "HIND, ROCK"                             
[301] "HIND, RED"                              
[302] "GRAYSBY"                                
[303] "SNAPPER, GLASSEYE"                      
[304] "REMORA, OTHER"                          
[305] "COTTONWICK"                             
[306] "DRUM, SPOTTED"                          
[307] "SPADEFISH, ATLANTIC"                    
[308] "DAMSELFISH, BICOLOR"                    
[309] "DICK, SLIPPERY"                         
[310] "WRASSE, YELLOWHEAD"                     
[311] "RAZORFISHES"                            
[312] "JAWFISH, YELLOWHEAD"                    
[313] "JAWFISH, DUSKY"                         
[314] "BLENNY, SADDLED"                        
[315] "FILEFISH, SCRAWLED"                     
[316] "SHRIMP, MARINE"                         
[317] "SHARKS, PELAGIC, UNC"                   
[318] "EELS, CONGER"                           
[319] "URCHINS, SEA"                           
[320] "ROBINS, SEA"                            
[321] "JAWFISH, OTHER"                         
[322] "BOXFISH"                                
[323] "TONGUE, FLAMINGO"                       
[324] "BLENNY, SAILFIN"                        
[325] "SNAPPER, DOG"                           
[326] "CORAL, DEEPWATER"                       
[327] "POMPANO, AFRICAN"                       
[328] "BARRACUDA, GREAT"                       
[329] "SURGEONFISHES"                          
[330] "BARRELFISH"                             
[331] "CRAB, GOLDEN DEEPSEA"                   
[332] "TRUMPETFISH"                            
[333] "SAND DOLLAR, OTHER"                     
[334] "POLYCHAETE, HORNED CHRISTMAS-T"         
[335] "CONCH, FLORIDA FIGHTING"                
[336] "HARE, SEA"                              
[337] "CRABS, BOX"                             
[338] "SKATES"                                 
[339] "MORAY, BLACKEDGE"                       
[340] "SCORPIONFISHES"                         
[341] "CREOLE-FISH"                            
[342] "SHARKSUCKER"                            
[343] "GOATFISH, SPOTTED"                      
[344] "AMBERJACK, LESSER"                      
[345] "RUDDERFISH, BANDED"                     
[346] "SNAPPER, BLACK"                         
[347] "FLOUNDER, SOUTHERN"                     
[348] "BASS, BANK SEA"                         
[349] "HERRING, ROUND"                         
[350] "HARVESTFISH"                            
[351] "TOMTATE"                                
[352] "GOBY, YELLOWLINE"                       
[353] "DEMOSPONGIAE"                           
[354] "URCHIN, PURPLE-SPINED SEA"              
[355] "FLOUNDER, GULF"                         
[356] "GROUPER, YELLOWMOUTH"                   
[357] "HALICLONA"                              
[358] "COWRIE, ATLANTIC DEER"                  
[359] "SNAIL, MOON"                            
[360] "EYE, SHARK"                             
[361] "DORIS, FLORIDA REGAL"                   
[362] "SHRIMP, MANTIS"                         
[363] "SEA STAR, OTHER"                        
[364] "TUNICATES, SEA SQUIRTS"                 
[365] "RAY, LESSER ELECTRIC"                   
[366] "CORNETFISH, RED"                        
[367] "SEAHORSES"                              
[368] "CARDINALFISHES"                         
[369] "PARROTFISH, MIDNIGHT"                   
[370] "PARROTFISH, REDBAND"                    
[371] "STARGAZERS"                             
[372] "PYGMY FILEFISH"                         
[373] "PUFFERS"                                
[374] "ANEMONE, OTHER"                         
[375] "CLAM, JEWEL BOX"                        
[376] "BRYOZOA"                                
[377] "SEA CUCUMBER, OTHER"                    
[378] "POLYCHAETE, FEATHER-DUSTER"             
[379] "SNAIL, HELMET"                          
[380] "SNAIL, TRITON"                          
[381] "WHELK, LIGHTNING"                       
[382] "SNAIL, CONE"                            
[383] "CHITON"                                 
[384] "SCALLOP"                                
[385] "CRAB, CORAL SPIDER"                     
[386] "BRITTLE STAR, OTHER"                    
[387] "LIZARDFISH, INSHORE"                    
[388] "TILEFISH, SAND"                         
[389] "CHROMIS, BROWN"                         
[390] "DAMSELFISH, LONGFIN"                    
[391] "WRASSE, CLOWN"                          
[392] "WRASSE, BLACKEAR"                       
[393] "PARROTFISH, STOPLIGHT"                  
[394] "BLENNY, HAIRY"                          
[395] "BLENNY, WRASSE"                         
[396] "BLENNY, GLASS"                          
[397] "FILEFISH, ORANGESPOTTED"                
[398] "TRUNKFISHES, THREE-ANGLED"              
[399] "RAYS, EAGLE"                            
[400] "PARROTFISH, PRINCESS"                   
[401] "SEA BISCUIT, OTHER"                     
[402] "SHARK, HAMMERHEAD"                      
[403] "SHARK, DUSKY"                           
[404] "SHARK, SANDBAR"                         
[405] "TILEFISH, GOLDFACE"                     
[406] "CONCH, CROWN"                           
[407] "OCTOPUS, CARIBBEAN REEF"                
[408] "OCTOPUS, ATLANTIC WHITE-SPOTTED"        
[409] "REEFFISH, YELLOWTAIL"                   
[410] "COWFISH, SCRAWLED"                      
[411] "PUFFER, SOUTHERN"                       
[412] "SHARK, BONNETHEAD"                      
[413] "SNAIL, STAR"                            
[414] "SNAIL, TOPSNAIL"                        
[415] "JACK, ALMACO"                           
[416] "BASS, ROCK SEA"                         
[417] "TRUNKFISH, SPOTTED"                     
[418] "JELLYFISH"                              
[419] "WENCHMAN"                               
[420] "SCHOOLMASTER"                           
[421] "SNAIL, PURPLE SEA"                      
[422] "CARDINALFISH, TWOSPOT"                  
[423] "PARROTFISH, RAINBOW"                    
[424] "PARROTFISH, QUEEN"                      
[425] "BLENNY, BARRED"                         
[426] "DAMSELFISH, COCOA"                      
[427] "WRECKFISH"                              
[428] "NEEDLEFISHES"                           
[429] "FLOUNDER, SUMMER"                       
[430] "SHARK, SMALL COASTAL SPECIES"           
[431] "JACK, BAR"                              
[432] "CONCH, MILK"                            
[433] "WHELK, KNOBBED"                         
[434] "GROUPER, MISTY"                         
[435] "SNAIL, OLIVE"                           
[436] "GROUPER, TIGER"                         
[437] "SNAPPER, MAHOGANY"                      
[438] "PENSHELL"                               
[439] "FLYINGFISHES"                           
[440] "STARGAZER, SOUTHERN"                    
[441] "SNAIL, MELAMPUS"                        
[442] "CRAB, FIDDLER"                          
[443] "CUBBYU"                                 
[444] "SWEEPER, GLASSY"                        
[445] "TRITON, ANGULAR"                        
[446] "CHUB, BERMUDA"                          
[447] "MAT, GREEN SEA"                         
[448] "POLYCHAETE, FIREWORM"                   
[449] "CONCH, OTHER"                           
[450] "ANGELWING"                              
[451] "CORNETFISH, BLUESPOTTED"                
[452] "CRAWFISH, FW"                           
[453] "FISHES, BUFFALO"                        
[454] "HAKE, RED"                              
[455] "BROTULA, BEARDED"                       
[456] "SCORPIONFISH, SPINYCHEEK"               
[457] "SCULPINS"                               
[458] "GROUPER, MARBLED"                       
[459] "RUNNER, RAINBOW"                        
[460] "RUNNER"                                 
[461] "MARGATE"                                
[462] "PORGY, RED"                             
[463] "TRIGGERFISH, GRAY"                      
[464] "SHARK, BLACKNOSE"                       
[465] "MELLITA"                                
[466] "JACK, HORSE-EYE"                        
[467] "ESCOLAR"                                
[468] "CRABS, SAND"                            
[469] "LOBSTER, SPOTTED SPINY"                 
[470] "DOLLAR, SAND"                           
[471] "MITER, FLORIDA"                         
[472] "MINNOWS"                                
[473] "DRUM, FRESHWATER"                       
[474] "SHARK, SILKY"                           
[475] "JACK, YELLOW"                           
[476] "SHARK, FINETOOTH"                       
[477] "SEA BISCUIT, INFLATED"                  
[478] "SAND DOLLAR, NOTCHED"                   
[479] "SNAPPER, CARIBBEAN RED"                 
[480] "PORGY, KNOBBED"                         
[481] "POMPANO, IRISH"                         
[482] "TIGER, SAND"                            
[483] "SNAIL, FIG"                             
[484] "SNAIL, FROGSNAIL"                       
[485] "SHAD, GIZZARD"                          
[486] "BREAM, RED"                             
[487] "TILEFISH, ANCHOR"                       
[488] "PORGY, JOLTHEAD"                        
[489] "ULOTRICHALES"                           
[490] "CUTLASSFISH, ATLANTIC"                  
[491] "SHARK, LARGE PELAGIC SPECIES"           
[492] "SQUIRRELFISHES"                         
[493] "ANEMONE, SUN ZOANTHID"                  
[494] "SNAIL, MARGINELLA"                      
[495] "SHARK, ATLANTIC SHARPNOSE"              
[496] "CRAB, RED DEEPSEA"                      
[497] "BASS, LONGTAIL"                         
[498] "POLYCHAETE, FANWORM"                    
[499] "SNAIL, NERITES"                         
[500] "CARP, COMMON"                           
[501] "JACK, BLACK"                            
[502] "WHITEFISHES"                            
[503] "PORGY, LONGSPINE"                       
[504] "SHARK, BIGNOSE"                         
[505] "PORGY, GRASS"                           
[506] "HERMIT, TRICOLOR"                       
[507] "CRABS, HERMIT"                          
[508] "ISOPOD, GIANT"                          
[509] "OPAH"                                   
[510] "CONCH, HAWKWING"                        
[511] "SHARK, SPINNER"                         
[512] "SHAD, THREADFIN"                        
[513] "PADDLEFISH"                             
[514] "PORGY, WHITEBONE"                       
[515] "POMFRETS"                               
[516] "HAKE, OFFSHORE"                         
[517] "TILEFISHES"                             
[518] "ROSEFISH, BLACKBELLY"                   
[519] "POMFRET, BIGSCALE"                      
[520] "CRAB, JONAH"                            
[521] "SCAD, BIGEYE"                           
[522] "CATFISH, BLUE"                          
[523] "CATFISH, CHANNEL"                       
[524] "FLOUNDER"                               
[525] "GAR, ALLIGATOR"                         
[526] "CATFISH, FLATHEAD"                      
[527] "SHELLFISH,OTHER"                        
[528] "KINGFISHES"                             
[529] "GAR, SPOTTED"                           
[530] "Procambarus"                            
[531] "SCORPIONFISH, LONGSNOUT"                
[532] "GROUPER, HIND RED"                      
[533] "GROUPER, SCAMP"                         
[534] "SPADEFISH"                              
[535] "DRIFTFISH, BLACK"                       
[536] "GROUPER, SPECKLED HIND"                 
[537] "BULLEYE"                                
[538] "RUDDERFISHES"                           
[539] "GAR, LONGNOSE"                          
[540] "GAR, SHORTNOSE"                         
[541] "TURTLES,SNAPPING"                       
[542] "TURTLE, ALLIGATOR SNAPPING"             
[543] "TURTLES, NORTH AMERICAN SOFTSHELL"      
[544] "CATFISH, HARDHEAD"                      
[545] "FLAG, SPANISH"                          
[546] "SLIDER, COMMON"                         
[547] "CARP, BIGHEAD"                          
[548] "BOWFIN"                                 
[549] "HADDOCK"                                
[550] "FROGS"                                  
[551] "BULLHEADS"                              
[552] "CARP, GRASS"                            
[553] "SCORPIONFISH, SPOTTED"                  
[554] "CRABS, HORSESHOE"                       
[555] "EEL, CONGER"                            
[556] "GOOSEFISH"                              
[557] "TURTLES"                                
[558] "ROVER, CRIMSON"                         
[559] "SHRIMP,ROCK"                            
[560] "CATFISH, GAFFTOPSAIL"                   
[561] "SHRIMP,FW"                              
[562] "COOTER, RIVER"                          
[563] "SHARK, BLUE"                            
[564] "Palaemonetes"                           
[565] "SHARK, COOKIECUTTER"                    
[566] "SHARK, SAND TIGER"                      
[567] "SHARKS, DOGFISH"                        
[568] "CARP, SILVER"                           
[569] "RUDDERFISH"                             
[570] "BLENNY, FLORIDA"                        
[571] "BLENNY, BANDED"                         
[572] "GAMBUSIA, MANGROVE"                     
[573] "STINGRAY, SOUTHERN"                     
[574] "PERIWINKLES, ATLANTIC"                  
[575] "CRAB, GREEN CLINGING"                   
[576] "PLANTAE"                                
[577] "CRAB, CALICO BOX"                       
[578] "CORALLIMORPHIDAE"                       
[579] "TRIGGERFISH, OCEAN"                     
[580] "SNAIL, WENTLETRAP"                      
[581] "LIZARDFISHES"                           
[582] "SHARK, HAMMERHEAD, SCALLOPED"           
[583] "DRUMS"                                  
[584] "MULLETS"                                
[585] "SHARK, SHORTFIN MAKO"                   
[586] "MACKERELS"                              
[587] "RAY, BAT"                               
[588] "PORBEAGLE"                              
[589] "SHARK, LONGFIN MAKO"                    
[590] "BUTTERFISH"                             
[591] "BARBIER, RED"                           
[592] "PORGY, LITTLEHEAD"                      
[593] "CHAETODON GUYANENSIS"                   
[594] "TILEFISH, BLACKLINE"                    
[595] "TURBINIDAE"                             
[596] "SHARK, ATLANTIC ANGEL"                  
[597] "BASS, WRASSE"                           
[598] "CRAB, RED AT"                           
[599] "SHARK, NIGHT"                           
[600] "BASSLET, THREELINE"                     
[601] "PILOTFISH"                              
[602] "GOBY, NAKED"                            
[603] "CUCUMBERS, SEA"                         
[604] "LEAFFISH, AFRICAN"                      
[605] "BASSES, MIXED SEA"                      
[606] "STAR, SERPENT BRITTLE"                  
[607] "BISCUIT, INFLATED SEA"                  
[608] "CUCUMBERS, OTHER SEA"                   
[609] "RICORDEA FLORIDA"                       
[610] "GOATFISHES"                             
[611] "FILEFISH, PYGMY"                        
[612] "STARS, BRITTLE"                         
[613] "BISCUITS, SEA"                          
[614] "DOLLARS, OTHER SAND"                    
[615] "DOLLAR, NOTCHED SAND"                   
[616] "STARS, OTHER SEA"                       
[617] "MACKEREL, ATLANTIC"                     
[618] "SEAROBINS"                              
[619] "CRABS, BRACHYURA"                       
[620] "NASSA, BRUISED"                         
[621] "OPHIDIIFORMES"                          
[622] "CRABS, LAND HERMIT"                     
[623] "SHARK, GREAT HAMMERHEAD"                
[624] "KINGFISH, GULF"                         
[625] "BLENNY, MARBLED"                        
[626] "SAND DOLLAR, 6-HOLED KEYHOLE"           
[627] "SHARK, HAMMERHEAD, GREAT"               
[628] "THREE-RIDGE"                            
[629] "MAPLELEAF"                              
[630] "WASHBOARD"                              
[631] "BLEUFER"                                
[632] "EEL,MORAYS"                             
[633] "BASS, ROUGHTONGUE"                      
[634] "PIPEFISHES"                             
[635] "EEL, SHARPTAIL"                         
[636] "FILEFISHES"                             
[637] "EEL, GOLDSPOTTED"                       
[638] "BUTTERFLYFISH, FRENCH"                  
[639] "STARS, FEATHER"                         
[640] "CORALLINACEAE"                          
[641] "TEGULA"                                 
[642] "SHRIMP, FARFANTEPENAEUS SPP"            
[643] "Squilla empusa"                         
[644] "KILLIFISHES"                            
[645] "JACK, BLUNTNOSE"                        
[646] "TURTLE, COMMON MUSK"                    
[647] "EELS,SNAKE"                             
[648] "SUCKERS"                                
[649] "EELS,CUSK"                              
[650] "CRAB, BLUE LAND"                        
[651] "DOLLARS, SIX-HOLED KEYHOLE SAND"        
[652] "ANIMALS, HYDRALIKE"                     
[653] "BASS, THREADNOSE"                       
[654] "PORCUPINEFISH"                          
[655] "COWRIE, ATLANTIC GRAY"                  
[656] "CODFISHES"                              
[657] "SHRIMP, PEDERSON CLEANER"               
[658] "CERITHIDEA"                             
[659] "NASSARIUS"                              
[660] "PAGURISTES PUNCTICEPS"                  
[661] "PAGURISTES ERYTHROPS"                   
[662] "HERMIT, GIANT"                          
[663] "HERMIT, ORANGECLAW"                     
[664] "CRAB, RED-RIDGED CLINGING"              
[665] "EEL, SPECKLED WORM"                     
[666] "HERMIT, STAREYE"                        
[667] "BURRFISH, SPOTTED"                      
[668] "BRYOPSIDALES"                           
[669] "GYMNACHIRUS"                            
[670] "SHRIMP, GOLDEN CORAL"                   
[671] "BROTULA, BLACK"                         
[672] "LIONFISH"                               
[673] "HAMLET, MUTTON"                         
[674] "CORALLIMORPHARIA"                       
[675] "CRABS, PORCELAIN"                       
[676] "BROTULA, KEY"                           
[677] "SQUID, ATLANTIC BRIEF"                  
[678] "SHARK, SMOOTH, DOGFISH"                 
[679] "SQUID, LONGFIN INSHORE"                 
[680] "DOGFISH, SMOOTH"                        
[681] "MITHRACULUS RUBER"                      
[682] "LIONFISH, RED"                          
[683] "CORALLIMORPH, DISCOSOMA"                
[684] "DRAGONETS"                              
[685] "GOBY, TIGER"                            
[686] "MITHRACULUS"                            
[687] "FROGFISHES"                             
[688] "TUNA, LITTLE TUNNY"                     
[689] "SHARK, THRESHER, BIGEYE"                
[690] "TILEFISH, GOLDEN"                       
[691] "ANEMONE, GIANT CARIBBEAN"               
[692] "RAYS, BUTTERFLY"                        
[693] "HAKES, RED AND WHITE"                   
[694] "BASS, CAVE"                             
[695] "GOATFISH, YELLOW"                       
[696] "TUNA, ALBACORE"                         
[697] "HIPPOGLOSSINA OBLONGA"                  
[698] "CATFISHES, BULLHEAD"                    
[699] "Rimapenaeus"                            
[700] "BIGEYE, SHORT"                          
[701] "LEATHERJACK"                            
[702] "SENNET, SOUTHERN"                       
[703] "LIONFISHES"                             
[704] "CRUSTACEANS"                            
[705] "PENS/PANSIES, SEA"                      
[706] "MAJOIDEA"                               
[707] "LIBINIA"                                
[708] "COWFISH, HONEYCOMBED"                   
[709] "GROUPER, CONEY"                         
[710] "MARGATE, BLACK"                         
[711] "ANIMALIA"                               
[712] "PERCH, DWARF SAND"                      
[713] "SNAILS"                                 
[714] "GRUNT, BARRED"                          
[715] "MOONEYES"                               
[716] "LOBSTER, SPINY"                         
[717] "REDFISHES"                              
[718] "TURTLE, RAZOR-BACKED MUSK"              
[719] "TURTLES, MUD"                           
[720] "PINFISH, SPOTTAIL"                      
[721] "CRABS, STONE"                           
[722] "FORAMS"                                 
[723] "SLEEPERS"                               
[724] "RED LIONFISH"                           
[725] "CROAKER, REEF"                          
[726] "RAVEN, SEA"                             
[727] "OCTOCORAL, SEA PENS/PANZIES"            
[728] "BASS, STRIPED"                          
[729] "PERCH, WHITE"                           
[730] "PERCH, YELLOW"                          
[731] "FROG, PIG"                              
[732] "RACER"                                  
[733] "SNAKE, DIAMONDBACK WATER"               
[734] "SNAKE, GREEN WATER"                     
[735] "SNAKE, RAT (TEXAS RAT SNAKE)"           
[736] "SNAKE, SOUTHERN WATER"                  
[737] "SNAKE, YELLOW-BELLIED WATER"            
[738] "GRUNTS, HAEMULIDAE (FAMILY)"            
[739] "OCTOPUSES"                              
[740] "SNAPPERS, LUTJANIDAE (FAMILY)"          
[741] "CLAM, QUAHOG, SOUTHERN"                 
[742] "SHRIMPS, BAIT"                          
[743] "SHARKS, PELAGIC"                        
[744] "GROUPERS, SERRANIDAE (FAMILY)"          
[745] "BIGEYES"                                
[746] "GRUNT, WHITE"                           
[747] "SNAILS, NASSA"                          
[748] "SNAIL, CHESTNUT TURBAN"                 
[749] "SNAILS, CERITHIDEAN"                    
[750] "URCHIN, GREEN SEA, (L. VARIEGATUS)"     
[751] "CRAB, HERMIT, STAREYE"                  
[752] "SNAILS, OLIVE"                          
[753] "TOADFISHES, BATRACHOIDIDAE (FAMILY)"    
[754] "CRABS, HERMIT, PAGUROIDEA (SUPERFAMILY)"
[755] "SKATES, RAJA (GENUS)"                   
[756] "STINGRAYS, DASYATIDAE (FAMILY)"         
[757] "SEAWEED, BRYOPSIDALES"                  
[758] "SOLES, NAKED AND FRINGED"               
[759] "PIPEFISHES, SYNGNATHINAE (SUBFAMILY)"   
[760] "CRAB, HERMIT, TRICOLOR"                 
[761] "DOLLARS, KEYHOLE SAND"                  
[762] "CRABS, DECAPODA (ORDER)"                
[763] "FLOUNDERS, LEFTEYED"                    
[764] "FLATFISHES"                             
[765] "SEAWEED, CAULERPA"                      
[766] "SPONGES, DEMOSPONGIAE"                  
[767] "SHRIMPS, PISTOL OR SNAPPING"            
[768] "EELS, MORAY"                            
[769] "EEL, MORAY, BLACKEDGE"                  
[770] "SNAIL, TRUE TULIP"                      
[771] "SHARK, SCALLOPED HAMMERHEAD"            
[772] "GOBY, VIOLET"                           
[773] "SNAILS, TURBAN"                         
[774] "CORALLIMORPH, FLORIDA"                  
[775] "SHRIMPS, MANTIS"                        
[776] "CRAB, HERMIT, ORANGECLAW"               
[777] "HERMIT, RED REEF"                       
[778] "SNAILS, NERITES"                        
[779] "CUCUMBER, DONKEY DUNG SEA"              
[780] "HARES, SEA"                             
[781] "CLAM, FILE, ROUGH"                      
[782] "SNAILS, TEGULA"                         
[783] "SEAWEED, HALIMEDA"                      
[784] "CRAB, HERMIT, GIANT"                    
[785] "CRAB, HERMIT, POLKADOTTED"              
[786] "URCHINS, SEA, ECHINOIDEA (CLASS)"       
[787] "CRAB, PAGURISTES PUNCTICEPS"            
[788] "POLYCHAETE, FANWORMS"                   
[789] "CUCUMBER, WEST INDIAN SEA"              
[790] "SCALLOPS"                               
[791] "SEAWEED, MERMAIDS SHAVING BRUSH"        
[792] "EEL, MORAY, SPOTTED"                    
[793] "SNAILS, TOPSNAIL"                       
[794] "CRAB, MITHRACULUS RUBER"                
[795] "JELLYFISHES, SCYPHOZOA (CLASS)"         
[796] "FROGFISHES, ANTENNARIIDAE (FAMILY)"     
[797] "BOXFISHES"                              
[798] "CLAM, FILE, SPINY"                      
[799] "CLAMS, PENSHELL"                        
[800] "EEL, MORAY, GREEN"                      
[801] "POLYCHAETE, FEATHER-DUSTERS"            
[802] "CLAM, BOX, JEWEL"                       
[803] "CLAMS"                                  
[804] "CRAB, HERMIT, THINSTRIPE"               
[805] "CRAB, PAGURISTES ERYTHROPS"             
[806] "DRUM, BLACKBAR"                         
[807] "PUFFERS, TETRAODONTIDAE (FAMILY)"       
[808] "ANOLE, GREEN"                           
[809] "SNAILS, MARGINELLA"                     
[810] "SKATES, RAJIDAE (FAMILY)"               
[811] "MACKEREL, ATLANTIC CHUB"                
[812] "FISHES, RAY-FINNED"                     
[813] "CRABS, FIDDLER"                         
[814] "TREEFROG, GREEN"                        
[815] "SNAKE, ROUGH GREEN"                     
[816] "TREEFROG, GRAY"                         
[817] "SNAKES, GARTER (RIBBON)"                
[818] "KINGSNAKE, SPECKLED"                    
[819] "TURTLE, PAINTED"                        
[820] "TURTLE, MISSISSIPPI MAP"                
[821] "TOADS, EUROPEAN SPADEFOOT"              
[822] "CUTLASSFISHES"                          
[823] "CRABS, MITHRACULUS"                     
[824] "EEL, MORAY, GOLDENTAIL"                 
[825] "REMORAS, OTHER"                         
[826] ""                                       
[827] "TOADS"                                  
[828] "DICOTYLEDONS"                           
[829] "SHARK, SHARPNOSE, ATLANTIC"             
[830] "GOBIES"                                 
[831] "ROCKSNAIL, FLORIDA"                     
[832] "PEEPER, SPRING"                         
[833] "BALLYHOOS"                              
[834] "JAWFISHES"                              
[835] "SNAILS, MUREX"                          
[836] "CUCUMBER, FOUR-SIDED SEA"               
[837] "AMPHIUMAS"                              
[838] "SNAIL, BRUISED NASSA"                   
[839] "SHARKS, SMALL COASTAL"                  
[840] "SNAIL, ANGULAR TRITON"                  
[841] "SHARK, SOUPFIN"                         
[842] "ALGAE, GREEN"                           
[843] "SHARK, OCEANIC WHITETIP"                
[844] "CHITONS"                                
[845] "POLYCHAETES, MARINE WORMS"              
[846] "SNAILS, MOON"                           
[847] "SNAILS, CONE"                           
[848] "SNAILS, FIG"                            
[849] "MUSSELS, PERNA"                         
[850] "LIZARDFISHES, SYNODONTIDAE (FAMILY)"    
[851] "CLAMS, MERCENARIA QUAHOG"               
[852] "JELLYFISH, CANNONBALL"                  
[853] "JELLYFISHES, STOMOLOPHUS (GENUS)"       
[854] "SHAD, HICKORY"                          
[855] "TURTLES, SNAPPING"                      
[856] "SHARK, SPINY DOGFISH"                   
[857] "SHARK, SMOOTHHOUND, FLORIDA"            
[858] "CRABS, CORAL SPIDER"                    
[859] "SNAIL, FLAMINGO TONGUE"                 
[860] "FROGS, CHORUS"                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"MENHADENS"</span>, <span class="at">ignore_case =</span> T))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MENHADENS"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"MENHADEN"</span>, <span class="at">ignore_case =</span> F ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MENHADENS"          "MENHADEN, ATLANTIC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"GROUPERS"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "GROUPERS"                      "GROUPERS, SERRANIDAE (FAMILY)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"GROUPER,"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "GROUPER, WARSAW"        "GROUPER, GAG"           "GROUPER, YELLOWEDGE"   
 [4] "GROUPER, RED"           "GROUPER, BLACK"         "GROUPER, YELLOWFIN"    
 [7] "GROUPER, SNOWY"         "GROUPER, NASSAU"        "GROUPER, YELLOWMOUTH"  
[10] "GROUPER, MISTY"         "GROUPER, TIGER"         "GROUPER, MARBLED"      
[13] "GROUPER, HIND RED"      "GROUPER, SCAMP"         "GROUPER, SPECKLED HIND"
[16] "GROUPER, CONEY"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"SNAPPER,"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SNAPPER, RED"           "SNAPPER, GRAY"          "SNAPPER, VERMILION"    
 [4] "SNAPPER, MUTTON"        "SNAPPER, LANE"          "SNAPPER, YELLOWTAIL"   
 [7] "SNAPPER, SILK"          "SNAPPER, CUBERA"        "SNAPPER, BLACKFIN"     
[10] "SNAPPER, QUEEN"         "SNAPPER, GLASSEYE"      "SNAPPER, DOG"          
[13] "SNAPPER, BLACK"         "SNAPPER, MAHOGANY"      "SNAPPER, CARIBBEAN RED"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"OYSTER,"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "OYSTER, EASTERN"         "OYSTER, ATLANTIC THORNY"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"CRAB,"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CRAB, BLUE"                  "CRAB, FLORIDA STONE"        
 [3] "CRAB, STONE"                 "CRAB, HORSESHOE"            
 [5] "CRAB, YELLOWLINE ARROW"      "CRAB, SPOTTED PORCELAIN"    
 [7] "CRAB, FALSE ARROW"           "CRAB, FURCATE SPIDER"       
 [9] "CRAB, REDFINGER RUBBLE"      "CRAB, NIMBLE SPRAY"         
[11] "CRAB, GOLDEN DEEPSEA"        "CRAB, CORAL SPIDER"         
[13] "CRAB, FIDDLER"               "CRAB, RED DEEPSEA"          
[15] "CRAB, JONAH"                 "CRAB, GREEN CLINGING"       
[17] "CRAB, CALICO BOX"            "CRAB, RED AT"               
[19] "CRAB, BLUE LAND"             "CRAB, RED-RIDGED CLINGING"  
[21] "CRAB, HERMIT, STAREYE"       "CRAB, HERMIT, TRICOLOR"     
[23] "CRAB, HERMIT, ORANGECLAW"    "CRAB, HERMIT, GIANT"        
[25] "CRAB, HERMIT, POLKADOTTED"   "CRAB, PAGURISTES PUNCTICEPS"
[27] "CRAB, MITHRACULUS RUBER"     "CRAB, HERMIT, THINSTRIPE"   
[29] "CRAB, PAGURISTES ERYTHROPS" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"STONE"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CRAB, FLORIDA STONE" "CRAB, STONE"         "CRABS, STONE"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"CRAB, BLUE"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CRAB, BLUE"      "CRAB, BLUE LAND"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"LOBSTER"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOBSTERS, SLIPPER"        "LOBSTER, CARIBBEAN SPINY"
[3] "LOBSTER, SPANISH"         "LOBSTER, AMERICAN"       
[5] "LOBSTER, SPOTTED SPINY"   "LOBSTER, SPINY"          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>com_names[<span class="fu">str_detect</span>(com_names, <span class="fu">regex</span>(<span class="st">"SHRIMP"</span>, <span class="at">ignore_case =</span> T ))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Brown Shrimp"                "White Shrimp"               
 [3] "Pink Shrimp"                 "SHRIMP, ATLANIC SEABOB"     
 [5] "SHRIMP, ROYAL RED"           "SHRIMP, ROCK"               
 [7] "SHRIMPS, PENAEOID"           "SHRIMP, ROUGHNECK"          
 [9] "SHRIMP, BAIT"                "SHRIMP, PISTOL OR SNAPPING" 
[11] "SHRIMP, BANDED CORAL"        "SHRIMP, PEPPERMINT"         
[13] "SHRIMP, CLEANER"             "SHRIMP, SPOTTED CLEANER"    
[15] "SHRIMP, MARINE"              "SHRIMP, MANTIS"             
[17] "SHRIMP,ROCK"                 "SHRIMP,FW"                  
[19] "SHRIMP, FARFANTEPENAEUS SPP" "SHRIMP, PEDERSON CLEANER"   
[21] "SHRIMP, GOLDEN CORAL"        "SHRIMPS, BAIT"              
[23] "SHRIMPS, PISTOL OR SNAPPING" "SHRIMPS, MANTIS"            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>GI <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">common_name_cleaned =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"GROUPER,</span><span class="sc">\\</span><span class="st">s*(WARSAW|GAG|YELLOWEDGE|RED|BLACK|YELLOWFIN|SNOWY|NASSAU|YELLOWMOUTH|MISTY|TIGER|MARBLED|HIND RED|SCAMP|SPECKLED HIND|CONEY)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Grouper"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"SNAPPER,</span><span class="sc">\\</span><span class="st">s*(RED|GRAY|VERMILION|MUTTON|LANE|YELLOWTAIL|SILK|CUBERA|BLACKFIN|QUEEN|GLASSEYE|DOG|BLACK|MAHOGANY|CARIBBEAN RED)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Snapper"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"CRAB,</span><span class="sc">\\</span><span class="st">s*(FLORIDA STONE|STONE)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Stone Crab"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"CRABS,</span><span class="sc">\\</span><span class="st">s*(FLORIDA STONE|STONE)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Stone Crab"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"CRABS,</span><span class="sc">\\</span><span class="st">s*(BLUE LAND|BLUE)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Blue Crab"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"CRAB,</span><span class="sc">\\</span><span class="st">s*(BLUE LAND|BLUE)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Blue Crab"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"LOBSTER,</span><span class="sc">\\</span><span class="st">s*(CARIBEAN SPINY|SPINY|SPOTTED SPINY|SPANISH|)"</span>, common_name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Spiny Lobster"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> common_name</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the data by dealer_city and count the distinct states for each city</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>city_state_counts <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">unique_states =</span> <span class="fu">n_distinct</span>(dealer_state),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_records =</span> <span class="fu">n</span>(),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">states =</span> <span class="fu">paste</span>(<span class="fu">unique</span>(dealer_state), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter cities linked to more than one state</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>cities_with_multiple_states <span class="ot">&lt;-</span> city_state_counts <span class="sc">%&gt;%</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_states <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cities_with_multiple_states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 4
   dealer_city     unique_states total_records states    
   &lt;chr&gt;                   &lt;int&gt;         &lt;int&gt; &lt;chr&gt;     
 1 #N/A                        3            31 TX, MS, FL
 2 ATLANTA                     2             7 LA, TX    
 3 BACLIFF                     2           105 TX, LA    
 4 BAKER                       2             6 FL, LA    
 5 BASTROP                     2            73 LA, TX    
 6 BAY SAINT LOUIS             2           571 MS, LA    
 7 CODEN                       2          1773 AL, MS    
 8 CRYSTAL BEACH               2            88 TX, FL    
 9 FORT LAUDERDALE             2          2029 FL, LA    
10 FREEPORT                    2          1695 TX, FL    
# ℹ 23 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cities_with_multiple_states, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(dealer_city, <span class="sc">-</span>unique_states), <span class="at">y =</span> unique_states)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cities in Multiple States"</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"City"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of States"</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vizualize states in which these cities appear in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the data by dealer_city and count the distinct states for each city</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>city_state_counts <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">unique_states =</span> <span class="fu">n_distinct</span>(dealer_state),  <span class="co"># Count of distinct states</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_records =</span> <span class="fu">n</span>(),                       <span class="co"># Total number of records for the city</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">states =</span> <span class="fu">paste</span>(<span class="fu">unique</span>(dealer_state), <span class="at">collapse =</span> <span class="st">", "</span>)  <span class="co"># List of states</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter cities linked to more than one state</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>cities_with_multiple_states <span class="ot">&lt;-</span> city_state_counts <span class="sc">%&gt;%</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_states <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View the results (including the list of states)</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cities_with_multiple_states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 4
   dealer_city     unique_states total_records states    
   &lt;chr&gt;                   &lt;int&gt;         &lt;int&gt; &lt;chr&gt;     
 1 #N/A                        3            31 TX, MS, FL
 2 ATLANTA                     2             7 LA, TX    
 3 BACLIFF                     2           105 TX, LA    
 4 BAKER                       2             6 FL, LA    
 5 BASTROP                     2            73 LA, TX    
 6 BAY SAINT LOUIS             2           571 MS, LA    
 7 CODEN                       2          1773 AL, MS    
 8 CRYSTAL BEACH               2            88 TX, FL    
 9 FORT LAUDERDALE             2          2029 FL, LA    
10 FREEPORT                    2          1695 TX, FL    
# ℹ 23 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print just the cities and their corresponding states for clarity</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cities_with_multiple_states <span class="sc">%&gt;%</span> <span class="fu">select</span>(dealer_city, states))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 2
   dealer_city     states    
   &lt;chr&gt;           &lt;chr&gt;     
 1 #N/A            TX, MS, FL
 2 ATLANTA         LA, TX    
 3 BACLIFF         TX, LA    
 4 BAKER           FL, LA    
 5 BASTROP         LA, TX    
 6 BAY SAINT LOUIS MS, LA    
 7 CODEN           AL, MS    
 8 CRYSTAL BEACH   TX, FL    
 9 FORT LAUDERDALE FL, LA    
10 FREEPORT        TX, FL    
# ℹ 23 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cities_with_multiple_states, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(dealer_city, <span class="sc">-</span>unique_states), <span class="at">y =</span> unique_states)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cities in Multiple States"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"City"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of States"</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "landed_year"         "data_supplier_st"    "dealer_id"          
 [4] "corporate_name"      "dealer_state"        "county_name"        
 [7] "dealer_city"         "zipcode"             "species_itis"       
[10] "common_name"         "live_lbs"            "value"              
[13] "Inflation_index"     "Adjust_factor"       "Adjusted_Val"       
[16] "common_name_cleaned"</code></pre>
</div>
</div>
<p>##Select Community Analysis</p>
<p>Filter Cities in FL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for cities in Florida</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>florida_cities <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_state <span class="sc">==</span> <span class="st">"FL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dealer_city) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View the unique cities in Florida</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(florida_cities)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              dealer_city
1                    #N/A
2       ALTAMONTE SPRINGS
3                    ALVA
4              ANNA MARIA
5            APALACHICOLA
6            APOLLO BEACH
7                  APOPKA
8                 ARCADIA
9                  ARCHER
10                ARIPEKA
11                  ASTOR
12         ATLANTIC BEACH
13             AUBURNDALE
14                 BAGDAD
15                  BAKER
16            BARBERVILLE
17                 BARTOW
18            BELLE GLADE
19              BELLEVIEW
20          BEVERLY HILLS
21        BIG COPPITT KEY
22           BIG PINE KEY
23            BLOUNTSTOWN
24            BOCA GRANDE
25             BOCA RATON
26               BOKEELIA
27                BONIFAY
28         BONITA SPRINGS
29          BOWLING GREEN
30          BOYNTON BEACH
31              BRADENTON
32        BRADENTON BEACH
33                BRANDON
34               BRANFORD
35                BRISTOL
36                BRONSON
37            BROOKSVILLE
38               CALLAHAN
39               CALLAWAY
40             CANTONMENT
41         CAPE CANAVERAL
42             CAPE CORAL
43                CAPTIVA
44             CARRABELLE
45              CARYVILLE
46            CASSELBERRY
47              CEDAR KEY
48              CHIEFLAND
49                CHIPLEY
50            CHOKOLOSKEE
51             CLEARWATER
52               CLERMONT
53                  COCOA
54            COCOA BEACH
55               COPELAND
56          CORAL SPRINGS
57                 CORTEZ
58             COTTONDALE
59          CRAWFORDVILLE
60          CRESCENT CITY
61              CRESTVIEW
62             CROSS CITY
63          CRYSTAL BEACH
64          CRYSTAL RIVER
65             CUDJOE KEY
66              DADE CITY
67            DANIA BEACH
68              DAVENPORT
69          DAYTONA BEACH
70      DE FUNIAK SPRINGS
71        DE LEON SPRINGS
72        DEERFIELD BEACH
73       DEFUNIAK SPRINGS
74                 DELAND
75           DELRAY BEACH
76                 DESTIN
77                  DOVER
78               DUCK KEY
79                DUNEDIN
80              DUNNELLON
81             EAGLE LAKE
82              EASTPOINT
83                   EBRO
84              EDGEWATER
85              ENGLEWOOD
86                 ESTERO
87                 EUSTIS
88             EVERGLADES
89        EVERGLADES CITY
90        FANNING SPRINGS
91              FELLSMERE
92       FERNANDINA BEACH
93          FLAGLER BEACH
94           FLORIDA CITY
95        FORT LAUDERDALE
96             FORT MYERS
97       FORT MYERS BEACH
98            FORT PIERCE
99      FORT WALTON BEACH
100            FORT WHITE
101              FOUNTAIN
102              FREEPORT
103           FREEPORT FL
104            FROSTPROOF
105           GAINESVILLE
106             GIBSONTON
107         GOLDEN MEADOW
108              GOODLAND
109            GRACEVILLE
110           GRAND RIDGE
111        GRANT-VALKARIA
112    GREEN COVE SPRINGS
113            GREENVILLE
114           GULF BREEZE
115          GULF HAMMOCK
116              GULFPORT
117                HAROLD
118              HASTINGS
119                HAVANA
120             HAWTHORNE
121        HERNANDO BEACH
122               HIALEAH
123               HOLIDAY
124             HOLLYWOOD
125          HOLMES BEACH
126                  HOLT
127             HOMESTEAD
128             HOMOSASSA
129     HOMOSASSA SPRINGS
130       HORSESHOE BEACH
131                HUDSON
132    INDIAN ROCKS BEACH
133         INDIAN SHORES
134                INGLIS
135             INVERNESS
136            ISLAMORADA
137          JACKSONVILLE
138    JACKSONVILLE BEACH
139          JENSEN BEACH
140               JUPITER
141              KATHLEEN
142          KENNETH CITY
143          KEY BISCAYNE
144      KEY COLONY BEACH
145             KEY LARGO
146              KEY WEST
147      KEYSTONE HEIGHTS
148                KINARD
149               LABELLE
150             LADY LAKE
151             LAKE CITY
152           LAKE GENEVA
153           LAKE MONROE
154            LAKE WORTH
155              LAKELAND
156                LAMONT
157        LANARK VILLAGE
158         LAND O' LAKES
159               LANTANA
160                 LARGO
161               LECANTO
162                   LEE
163              LEESBURG
164          LEHIGH ACRES
165      LITTLE TORCH KEY
166              LIVE OAK
167              LONG KEY
168          LONGBOAT KEY
169                LORIDA
170                  LUTZ
171            LYNN HAVEN
172         MADEIRA BEACH
173               MADISON
174              MAITLAND
175                 MANGO
176              MARATHON
177       MARATHON SHORES
178          MARCO ISLAND
179               MARGATE
180          MARSHALLBERG
181           MARY ESTHER
182              MATLACHA
183                  MAYO
184                MEDLEY
185             MELBOURNE
186               MELROSE
187        MERRITT ISLAND
188          MEXICO BEACH
189                 MIAMI
190           MIAMI BEACH
191                 MICCO
192            MIDDLEBURG
193                MILTON
194                  MIMS
195               MIRAMAR
196            MONTICELLO
197             MORRISTON
198           MYAKKA CITY
199                NAPLES
200               NAVARRE
201       NEW PORT RICHEY
202      NEW SMYRNA BEACH
203              NEWBERRY
204             NICEVILLE
205               NOCATEE
206               NOKOMIS
207      NORTH FORT MYERS
208      NORTH LAUDERDALE
209           NORTH MIAMI
210     NORTH MIAMI BEACH
211      NORTH PALM BEACH
212            NORTH PORT
213 NORTH REDINGTON BEACH
214               O'BRIEN
215              OAK HILL
216          OAKLAND PARK
217                 OCALA
218                ODESSA
219            OKEECHOBEE
220              OLD TOWN
221               OLDSMAR
222                 ONECO
223               ORLANDO
224          ORMOND BEACH
225                OSPREY
226           OTTER CREEK
227                OXFORD
228                  PACE
229               PALATKA
230              PALM BAY
231    PALM BEACH GARDENS
232            PALM COAST
233           PALM HARBOR
234              PALMETTO
235          PALMETTO BAY
236               PANACEA
237           PANAMA CITY
238     PANAMA CITY BEACH
239                PARKER
240               PARRISH
241             PENSACOLA
242       PENSACOLA BEACH
243                 PERRY
244              PINELAND
245         PINELLAS PARK
246               PLACIDA
247            PLANT CITY
248            PLANTATION
249              PLYMOUTH
250      POINT WASHINGTON
251           POMONA PARK
252         POMPANO BEACH
253         PONCE DE LEON
254           PONTE VEDRA
255        PORT CANAVERAL
256        PORT CHARLOTTE
257           PORT ORANGE
258           PORT RICHEY
259        PORT SAINT JOE
260      PORT SAINT LUCIE
261          PORT SALERNO
262        PORT ST. LUCIE
263             PRINCETON
264           PUNTA GORDA
265                QUINCY
266      REDINGTON SHORES
267           RIDGE MANOR
268             RIVERVIEW
269         RIVIERA BEACH
270             ROCKLEDGE
271              ROSELAND
272               RUBONIA
273                RUSKIN
274         SAFETY HARBOR
275       SAINT AUGUSTINE
276           SAINT CLOUD
277   SAINT GEORGE ISLAND
278      SAINT JAMES CITY
279           SAINT MARKS
280      SAINT PETERSBURG
281          SALT SPRINGS
282               SANFORD
283               SANIBEL
284      SANTA ROSA BEACH
285              SARASOTA
286          SCOTTS FERRY
287             SEBASTIAN
288               SEFFNER
289              SEMINOLE
290              SHALIMAR
291        SILVER SPRINGS
292                SNEADS
293             SOPCHOPPY
294              SORRENTO
295             SOUTHPORT
296           SPRING HILL
297           SPRINGFIELD
298         ST PETE BEACH
299        ST. PETE BEACH
300          STEINHATCHEE
301                STUART
302         SUGARLOAF KEY
303      SUGARLOAF SHORES
304        SUMMERLAND KEY
305       SUN CITY CENTER
306               SUNRISE
307              SUWANNEE
308           TALLAHASSEE
309                 TAMPA
310        TARPON SPRINGS
311               TAVARES
312             TAVERNIER
313              TEQUESTA
314            TERRA CEIA
315          THE VILLAGES
316          THONOTOSASSA
317          TIERRA VERDE
318            TITUSVILLE
319       TREASURE ISLAND
320               TRENTON
321              UMATILLA
322               UNKNOWN
323            UNKNOWN_FL
324            UNRESOLVED
325            VALPARAISO
326                VENICE
327             VENICE FL
328                VERNON
329            VERO BEACH
330       WAKULLA SPRINGS
331               WEBSTER
332          WEEKI WACHEE
333       WEST PALM BEACH
334           WEWAHITCHKA
335              WILDWOOD
336             WILLISTON
337               WIMAUMA
338          WINTER HAVEN
339           WINTER PARK
340        WINTER SPRINGS
341            YANKEETOWN
342            YOUNGSTOWN
343                 YULEE
344           ZEPHYRHILLS</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the cities of interest</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>cities_of_interest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BIG PINE KEY"</span>, <span class="st">"BOKEELIA"</span>, <span class="st">"CHOKOLOSKEE"</span>, <span class="st">"CORTEZ"</span>, <span class="st">"DESTIN"</span>, <span class="st">"EVERGLADES CITY"</span>, <span class="st">"HIALEAH"</span>, <span class="st">"KEY LARGO"</span>, <span class="st">"KEY WEST"</span>, <span class="st">"MADEIRA BEACH"</span>, <span class="st">"MARCO ISLAND"</span>, <span class="st">"MATLACHA"</span>, <span class="st">"MIAMI"</span>, <span class="st">"PINELAND"</span>, <span class="st">"SANIBEL"</span>, <span class="st">"STEINHATCHEE"</span>, <span class="st">"TARPON SPRINGS"</span>, <span class="st">"VENICE"</span>,              </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="st">"VENICE FL"</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for these cities</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">%in%</span> cities_of_interest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Step 2: Summarize the Fish Portfolio Create a summary to understand the portfolio of fish species for each city over time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the portfolio of fish species for each city over time</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fish_portfolio <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city, landed_year, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_lbs =</span> <span class="fu">sum</span>(live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_value =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dealer_city', 'landed_year'. You can
override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fish_portfolio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34,778 × 5
# Groups:   dealer_city, landed_year [645]
   dealer_city  landed_year common_name_cleaned      total_lbs total_value
   &lt;chr&gt;              &lt;int&gt; &lt;chr&gt;                        &lt;dbl&gt;       &lt;dbl&gt;
 1 BIG PINE KEY        1989 SPONGE, GRASS                16165       43689
 2 BIG PINE KEY        1989 SPONGE, YELLOW               29491       79431
 3 BIG PINE KEY        1989 SPONGES, SHEEPSWOOL          70285      381254
 4 BIG PINE KEY        1990 ANEMONE, RINGED                 88           2
 5 BIG PINE KEY        1990 ANEMONE, SPECKLED             1484        1695
 6 BIG PINE KEY        1990 ANEMONE, SUN                   353         564
 7 BIG PINE KEY        1990 ANENONE, GIANT CARIBBEAN      7228        2820
 8 BIG PINE KEY        1990 ANGELFISH, BLUE               1502        9005
 9 BIG PINE KEY        1990 ANGELFISH, FRENCH               67         599
10 BIG PINE KEY        1990 ANGELFISH, GRAY                707        4024
# ℹ 34,768 more rows</code></pre>
</div>
</div>
<p>To determine the top 3 species by Adjusted Value for each city for each decade:</p>
<p>Filter and Create Decade Column: Add a column to represent the decade each record belongs to. Group and Summarize: Group the data by city, decade, and species, then summarize by the total Adjusted Value. Rank and Filter: Rank the species within each city and decade, and filter to keep only the top 3.</p>
<p>Step 1: Filter and Create Decade Column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a decade column to the data</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>GI <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(landed_year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="big-pine-key" class="level2">
<h2 class="anchored" data-anchor-id="big-pine-key">BIG PINE KEY</h2>
</section>
<section id="hurricanes-that-impacted-big-pine-key" class="level1">
<h1>Hurricanes that impacted Big Pine Key</h1>
<p>Hurricane Donna (1960): This hurricane wreaked havoc in the Middle and Upper Keys. Big Pine Key experienced significant damage, with sustained winds reported at 140 mph and gusts up to 180 mph. Tidal surges ranged from 8 to 13.5 feet.</p>
<p>Hurricane Betsy (1965): Known for changing direction multiple times, Betsy severely damaged the Middle and Lower Keys, including Big Pine Key. The island reported wind gusts as high as 160 mph and confirmed tornadoes in the area.</p>
<p>Hurricane Georges (1998): Georges caused substantial damage in the Florida Keys, including Big Pine Key. The storm brought strong winds and significant storm surge, leading to widespread flooding and structural damage.</p>
<p>Hurricane Wilma (2005): This hurricane brought severe storm surge and flooding to the Florida Keys, including Big Pine Key. It caused extensive property damage and disruption.</p>
<p>Hurricane Irma (2017): One of the most impactful hurricanes in recent history, Irma made landfall in the Keys as a Category 4 hurricane. Big Pine Key, along with Cudjoe Key, took the brunt of the storm. The area was left devastated, with widespread destruction of homes and infrastructure. The Key Deer refuge on Big Pine Key was also heavily impacted</p>
<p>#Step 2: Group, Summarize, Rank, and Filter</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with NAs in relevant columns</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dealer_city) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(landed_year) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(common_name_cleaned) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Adjusted_Val))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a decade column to the data</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(landed_year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>big_pine_key_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Group, summarize, rank, and filter to get top 3 species by Adjusted Value for Big Pine Key for each decade</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>top_species_bpk <span class="ot">&lt;-</span> big_pine_key_data <span class="sc">%&gt;%</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city, decade, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city, decade, <span class="fu">desc</span>(total_adjusted_value)) <span class="sc">%&gt;%</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city, decade) <span class="sc">%&gt;%</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city, decade, rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dealer_city', 'decade'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>summary_table_bpk <span class="ot">&lt;-</span> top_species_bpk <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rank, <span class="at">values_from =</span> <span class="fu">c</span>(common_name_cleaned, total_adjusted_value), </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"species_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city, decade)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary table</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_table_bpk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  dealer_city  decade common_name_cleaned_species_1 common_name_cleaned_specie…¹
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;                         &lt;chr&gt;                       
1 BIG PINE KEY   1980 SPONGES, SHEEPSWOOL           SPONGE, YELLOW              
2 BIG PINE KEY   1990 SPONGES, SHEEPSWOOL           Spiny Lobster               
3 BIG PINE KEY   2000 RICORDEA FLORIDA              HERMIT, TRICOLOR            
4 BIG PINE KEY   2010 Spiny Lobster                 Stone Crab                  
5 BIG PINE KEY   2020 Spiny Lobster                 Stone Crab                  
# ℹ abbreviated name: ¹​common_name_cleaned_species_2
# ℹ 4 more variables: common_name_cleaned_species_3 &lt;chr&gt;,
#   total_adjusted_value_species_1 &lt;dbl&gt;, total_adjusted_value_species_2 &lt;dbl&gt;,
#   total_adjusted_value_species_3 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visualization for Big Pine Key</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_species_bpk, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> total_adjusted_value, <span class="at">fill =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(common_name_cleaned <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Spiny Lobster"</span>, <span class="st">"Stone Crab"</span>, <span class="st">"Blue Crab"</span>, <span class="st">"Snapper"</span>), common_name_cleaned, <span class="st">""</span>)), </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 3 Species by Adjusted Value for Big Pine Key by Decade"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Adjusted Value"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Species"</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Landed Pounds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with NAs in relevant columns</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dealer_city) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(landed_year) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(common_name_cleaned) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(live_lbs))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a decade column to the data</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(landed_year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>big_pine_key_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span>)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Group, summarize, rank, and filter to get top 3 species by live lbs for Big Pine Key for each decade</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>top_species_bpk <span class="ot">&lt;-</span> big_pine_key_data <span class="sc">%&gt;%</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city, decade, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_live_lbs =</span> <span class="fu">sum</span>(live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city, decade, <span class="fu">desc</span>(total_live_lbs)) <span class="sc">%&gt;%</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dealer_city, decade) <span class="sc">%&gt;%</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city, decade, rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dealer_city', 'decade'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>summary_table_bpk <span class="ot">&lt;-</span> top_species_bpk <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rank, <span class="at">values_from =</span> <span class="fu">c</span>(common_name_cleaned, total_live_lbs), </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"species_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dealer_city, decade)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary table</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_table_bpk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  dealer_city  decade common_name_cleaned_species_1 common_name_cleaned_specie…¹
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;                         &lt;chr&gt;                       
1 BIG PINE KEY   1980 SPONGES, SHEEPSWOOL           SPONGE, YELLOW              
2 BIG PINE KEY   1990 SPONGES, SHEEPSWOOL           Spiny Lobster               
3 BIG PINE KEY   2000 HERMIT, TRICOLOR              SNAIL, STAR                 
4 BIG PINE KEY   2010 HERMIT, TRICOLOR              TURBINIDAE                  
5 BIG PINE KEY   2020 Spiny Lobster                 Stone Crab                  
# ℹ abbreviated name: ¹​common_name_cleaned_species_2
# ℹ 4 more variables: common_name_cleaned_species_3 &lt;chr&gt;,
#   total_live_lbs_species_1 &lt;dbl&gt;, total_live_lbs_species_2 &lt;dbl&gt;,
#   total_live_lbs_species_3 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visualization for Big Pine Key</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_species_bpk, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> total_live_lbs, <span class="at">fill =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(common_name_cleaned <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Spiny Lobster"</span>, <span class="st">"Stone Crab"</span>, <span class="st">"Blue Crab"</span>), common_name_cleaned, <span class="st">""</span>)), </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 3 Species by Live Lbs for Big Pine Key by Decade"</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Live Lbs"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Species"</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with NAs in relevant columns</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dealer_city) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(landed_year) <span class="sc">&amp;</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(common_name_cleaned) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(live_lbs) <span class="sc">&amp;</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(Adjusted_Val))</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key and the specified species</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>species_of_interest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Snapper"</span>, <span class="st">"Blue Crab"</span>, <span class="st">"Stone Crab"</span>, <span class="st">"Spiny Lobster"</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>big_pine_key_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> common_name_cleaned <span class="sc">%in%</span> species_of_interest)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> big_pine_key_data <span class="sc">%&gt;%</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_live_lbs =</span> <span class="fu">sum</span>(live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(landed_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'landed_year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 4
# Groups:   landed_year [31]
   landed_year common_name_cleaned total_live_lbs total_adjusted_value
         &lt;int&gt; &lt;chr&gt;                        &lt;dbl&gt;                &lt;dbl&gt;
 1        1990 Spiny Lobster                  715                 5524
 2        1991 Spiny Lobster                37269               282343
 3        1991 Stone Crab                    3760                15432
 4        1992 Snapper                        124                  663
 5        1992 Spiny Lobster                31535               205901
 6        1992 Stone Crab                   10022                44701
 7        1993 Spiny Lobster                14945                84501
 8        1993 Stone Crab                    5684                28862
 9        1994 Snapper                         85                  237
10        1994 Spiny Lobster                21069               148247
# ℹ 80 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for Live Pounds over time</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> total_live_lbs, <span class="at">color =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Landed Pounds for Selected Species in Big Pine Key Over Time"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Live Pounds"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Species"</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for Adjusted Value over time</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> total_adjusted_value, <span class="at">color =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Adjusted Value for Selected Species in Big Pine Key Over Time"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Adjusted Value"</span>,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Species"</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with NAs in relevant columns</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dealer_city) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(landed_year) <span class="sc">&amp;</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(common_name_cleaned) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(live_lbs) <span class="sc">&amp;</span> </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(Adjusted_Val))</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key and the specified species</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>species_of_interest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Snapper"</span>, <span class="st">"Blue Crab"</span>, <span class="st">"Stone Crab"</span>, <span class="st">"Spiny Lobster"</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>big_pine_key_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> common_name_cleaned <span class="sc">%in%</span> species_of_interest)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> big_pine_key_data <span class="sc">%&gt;%</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_live_lbs =</span> <span class="fu">sum</span>(live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(landed_year)</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary data</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 4
   landed_year common_name_cleaned total_live_lbs total_adjusted_value
         &lt;int&gt; &lt;chr&gt;                        &lt;dbl&gt;                &lt;dbl&gt;
 1        1990 Spiny Lobster                  715                 5524
 2        1991 Spiny Lobster                37269               282343
 3        1991 Stone Crab                    3760                15432
 4        1992 Snapper                        124                  663
 5        1992 Spiny Lobster                31535               205901
 6        1992 Stone Crab                   10022                44701
 7        1993 Spiny Lobster                14945                84501
 8        1993 Stone Crab                    5684                28862
 9        1994 Snapper                         85                  237
10        1994 Spiny Lobster                21069               148247
# ℹ 80 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hurricane years and labels</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>hurricane_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2005</span>, <span class="dv">2017</span>),</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Georges"</span>, <span class="st">"Wilma"</span>, <span class="st">"Irma"</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate y-position for the labels</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>max_live_lbs <span class="ot">&lt;-</span> <span class="fu">max</span>(summary_data<span class="sc">$</span>total_live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>max_adjusted_value <span class="ot">&lt;-</span> <span class="fu">max</span>(summary_data<span class="sc">$</span>total_adjusted_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for Live Pounds over time</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> total_live_lbs, <span class="at">color =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> year), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> max_live_lbs, <span class="at">label =</span> label), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Landed Pounds for Selected Species in Big Pine Key Over Time"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Live Pounds"</span>,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Species"</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for Adjusted Value over time</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> total_adjusted_value, <span class="at">color =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> year), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> max_adjusted_value, <span class="at">label =</span> label), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Adjusted Value for Selected Species in Big Pine Key Over Time"</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Adjusted Value"</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Species"</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with NAs in relevant columns</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dealer_city) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(landed_year))</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>big_pine_key_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the number of dealers by year</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>dealer_summary <span class="ot">&lt;-</span> big_pine_key_data <span class="sc">%&gt;%</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year) <span class="sc">%&gt;%</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_of_dealers =</span> <span class="fu">n_distinct</span>(dealer_id),</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(landed_year)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary data</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dealer_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 2
   landed_year number_of_dealers
         &lt;int&gt;             &lt;int&gt;
 1        1989                 1
 2        1990                 4
 3        1991                 7
 4        1992                 8
 5        1993                 7
 6        1994                 7
 7        1995                 7
 8        1996                 7
 9        1997                 5
10        1998                 6
# ℹ 22 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hurricane years and labels</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>hurricane_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2005</span>, <span class="dv">2017</span>),</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Georges"</span>, <span class="st">"Wilma"</span>, <span class="st">"Irma"</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate y-position for the labels</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>max_dealers <span class="ot">&lt;-</span> <span class="fu">max</span>(dealer_summary<span class="sc">$</span>number_of_dealers, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for the number of dealers over time</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dealer_summary, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> number_of_dealers)) <span class="sc">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> year), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> max_dealers, <span class="at">label =</span> label), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Dealers in Big Pine Key Over Time"</span>,</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Dealers"</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key in 2017</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>dealers_2017 <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> landed_year <span class="sc">==</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dealer_id, corporate_name) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View the dealers</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dealers_2017)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dealer_id                       corporate_name
1      45401    BECKER              VERNIE      J
2    3508687                         GBU FISH INC
3      35992 ROCKETT             GEORGE      WIII
4    3506812                       DG SEAFOOD LLC
5    1572922                         SEA CRITTERS
6    3740380             HOLROYD ENTERPRISES INC.
7    3060293            SOUTHERN OCEAN DIRECT LLC
8      70526    DOMINICAK           WILLIAM     N
9      77695    GOULD               PHILLIP     N
10     76337    BURKMAN             KEITH       L
11   3541262                     PULLEY, AMY LYNN
12   3728714                    SULLIVAN, STEPHEN
13     79708    SHARP               JEREMY      D
14   1574605                     FUN YET CHARTERS
15   3410641                      ANGELL, MATTHEW
16     58304    PEREZ               PEDRO       M
17   2173713                       MILLSAPS JAMES
18     77509    KULL                KENNETH     G
19   3507622                    KEYS CUISINE, INC
20   3403790                       KRUSZKA, LINDA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># List of specific dealers for Big Pine Key in 2017</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>specific_dealers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BECKER VERNIE J"</span>, <span class="st">"GBU FISH INC"</span>, <span class="st">"ROCKETT GEORGE WIII"</span>, <span class="st">"DG SEAFOOD LLC"</span>, </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"SEA CRITTERS"</span>, <span class="st">"HOLROYD ENTERPRISES INC."</span>, <span class="st">"SOUTHERN OCEAN DIRECT LLC"</span>, </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DOMINICAK WILLIAM N"</span>, <span class="st">"GOULD PHILLIP N"</span>, <span class="st">"BURKMAN KEITH L"</span>, <span class="st">"SULLIVAN, STEPHEN"</span>, <span class="st">"PULLEY, AMY LYNN"</span>, <span class="st">"SHARP JEREMY D"</span>, <span class="st">"FUN YET CHARTERS"</span>, <span class="st">"ANGELL, MATTHEW"</span>, <span class="st">"PEREZ PEDRO M"</span>, <span class="st">"MILLSAPS JAMES"</span>, <span class="st">"KULL KENNETH G"</span>, <span class="st">"KEYS CUISINE, INC"</span>, <span class="st">"KRUSZKA, LINDA"</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key and the specific dealers</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>big_pine_key <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(corporate_name <span class="sc">%in%</span> specific_dealers)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing dealers</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>missing_dealers <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(specific_dealers, <span class="fu">unique</span>(big_pine_key<span class="sc">$</span>corporate_name))</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Missing dealers:"</span>, <span class="fu">paste</span>(missing_dealers, <span class="at">collapse =</span> <span class="st">", "</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Missing dealers: ROCKETT GEORGE WIII, DOMINICAK WILLIAM N, GOULD PHILLIP N, SHARP JEREMY D, KULL KENNETH G"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year and dealer</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> big_pine_key <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year, corporate_name) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_live_lbs =</span> <span class="fu">sum</span>(live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(corporate_name, landed_year)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary data</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 78 × 4
   landed_year corporate_name  total_live_lbs total_adjusted_value
         &lt;int&gt; &lt;chr&gt;                    &lt;dbl&gt;                &lt;dbl&gt;
 1        2013 ANGELL, MATTHEW          5540                 13367
 2        2014 ANGELL, MATTHEW           246                  2341
 3        2015 ANGELL, MATTHEW          7095.                20626
 4        2016 ANGELL, MATTHEW          3271.                20097
 5        2017 ANGELL, MATTHEW          5566                 26231
 6        2019 BECKER VERNIE J        144942               1469790
 7        2019 BURKMAN KEITH L            30                   243
 8        2014 DG SEAFOOD LLC          39708.               525980
 9        2015 DG SEAFOOD LLC         117652.              1054346
10        2016 DG SEAFOOD LLC          85928.               776083
# ℹ 68 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a long format for faceting</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>summary_data_long <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(total_live_lbs, total_adjusted_value), </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hurricane years and labels</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>hurricane_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2005</span>, <span class="dv">2017</span>),</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Georges"</span>, <span class="st">"Wilma"</span>, <span class="st">"Irma"</span>)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate y-position for the labels</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>max_value <span class="ot">&lt;-</span> <span class="fu">max</span>(summary_data_long<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with facets for each dealer</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data_long, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> value, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> corporate_name, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> year), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> max_value, <span class="at">label =</span> label), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Adjusted Value and Live Pounds Over Time for Dealers in Big Pine Key"</span>,</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Value"</span>,</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Metric"</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?
`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?
`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#Only dealers with multiple year landings</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># List of specific dealers for Big Pine Key in 2017</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>top_dealers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GBU FISH INC"</span>, <span class="st">"DG SEAFOOD LLC"</span>, </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"SEA CRITTERS"</span>, <span class="st">"HOLROYD ENTERPRISES INC."</span>, <span class="st">"SOUTHERN OCEAN DIRECT LLC"</span>, <span class="st">"SULLIVAN, STEPHEN"</span>, <span class="st">"PULLEY, AMY LYNN"</span>, <span class="st">"FUN YET CHARTERS"</span>, <span class="st">"KEYS CUISINE, INC"</span>, <span class="st">"KRUSZKA, LINDA"</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Big Pine Key and the specific dealers</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>big_pine_key <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(corporate_name <span class="sc">%in%</span> top_dealers)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing dealers</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>missing_dealers <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(top_dealers, <span class="fu">unique</span>(big_pine_key<span class="sc">$</span>corporate_name))</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Missing dealers:"</span>, <span class="fu">paste</span>(missing_dealers, <span class="at">collapse =</span> <span class="st">", "</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Missing dealers: "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year and dealer</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> big_pine_key <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year, corporate_name) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_live_lbs =</span> <span class="fu">sum</span>(live_lbs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(corporate_name, landed_year)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary data</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 4
   landed_year corporate_name   total_live_lbs total_adjusted_value
         &lt;int&gt; &lt;chr&gt;                     &lt;dbl&gt;                &lt;dbl&gt;
 1        2014 DG SEAFOOD LLC           39708.               525980
 2        2015 DG SEAFOOD LLC          117652.              1054346
 3        2016 DG SEAFOOD LLC           85928.               776083
 4        2017 DG SEAFOOD LLC           32248                163846
 5        2018 DG SEAFOOD LLC           57101                597803
 6        2019 DG SEAFOOD LLC           26681                322628
 7        2020 DG SEAFOOD LLC            3206                 36922
 8        2007 FUN YET CHARTERS           464                  3181
 9        2008 FUN YET CHARTERS          1675                  9195
10        2009 FUN YET CHARTERS          1308                  7979
# ℹ 56 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a long format for faceting</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>summary_data_long <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(total_live_lbs, total_adjusted_value), </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hurricane years and labels</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>hurricane_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2005</span>, <span class="dv">2017</span>),</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Georges"</span>, <span class="st">"Wilma"</span>, <span class="st">"Irma"</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate y-position for the labels</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>max_value <span class="ot">&lt;-</span> <span class="fu">max</span>(summary_data_long<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with facets for each dealer</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data_long, <span class="fu">aes</span>(<span class="at">x =</span> landed_year, <span class="at">y =</span> value, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> corporate_name, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> year), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hurricane_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> max_value, <span class="at">label =</span> label), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Adjusted Value and Live Pounds Over Time for Dealers in Big Pine Key"</span>,</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Value"</span>,</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Metric"</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="clearly-hurricane-irma-had-a-negative-impact-on-the-seafood-dealers-in-bpk.-the-overal-landings-decreased-and-the-number-of-dealers-dropped-by-50-percent-from-20-to-10." class="level2">
<h2 class="anchored" data-anchor-id="clearly-hurricane-irma-had-a-negative-impact-on-the-seafood-dealers-in-bpk.-the-overal-landings-decreased-and-the-number-of-dealers-dropped-by-50-percent-from-20-to-10.">clearly Hurricane Irma had a negative impact on the seafood dealers in BPK. The overal landings decreased and the number of dealers dropped by 50 percent (from 20 to 10).</h2>
<p>Analyze the top 5 species by adjusted value landed by “Southern Ocean Direct LLC” in Big Pine Key since 2010, follow these steps:</p>
<p>Filter the Data: Focus on the data for “Southern Ocean Direct LLC” in Big Pine Key since 2010. Summarize by Year and Species: Calculate the total Adjusted Value for each species within each year. Rank and Filter: Rank species within each year and filter to get the top five.</p>
<p>Highlight: SOUTHERN OCEAN DIRECT LLC which did well</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for Southern Ocean Direct LLC in Big Pine Key since 2010</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>sod_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> corporate_name <span class="sc">==</span> <span class="st">"SOUTHERN OCEAN DIRECT LLC"</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year and species</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>species_summary <span class="ot">&lt;-</span> sod_data <span class="sc">%&gt;%</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(landed_year, <span class="fu">desc</span>(total_adjusted_value))</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank and filter to get top 10 species for each year</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>top_species <span class="ot">&lt;-</span> species_summary <span class="sc">%&gt;%</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year) <span class="sc">%&gt;%</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View the top species</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 4
   landed_year common_name_cleaned     total_adjusted_value  rank
         &lt;int&gt; &lt;chr&gt;                                  &lt;dbl&gt; &lt;int&gt;
 1        2010 TURBINIDAE                             34881     1
 2        2010 HERMIT, TRICOLOR                       26835     2
 3        2010 CRAB, GREEN CLINGING                   14908     3
 4        2010 ANGELFISH, BLUE                         1013     4
 5        2010 TANG, BLUE                               167     5
 6        2010 CRAB, YELLOWLINE ARROW                   111     6
 7        2010 PLANT, HALIMEDA                           66     7
 8        2010 CRAB, SPOTTED PORCELAIN                   43     8
 9        2010 BLENNY, OTHER                             35     9
10        2010 HIGH-HAT                                  28    10
# ℹ 70 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_species, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(landed_year), <span class="at">y =</span> total_adjusted_value, <span class="at">fill =</span> common_name_cleaned)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 10 Species by Adjusted Value for Southern Ocean Direct LLC in Big Pine Key (2010 onwards)"</span>,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Adjusted Value"</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Species"</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at key species for this region</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert common_name_cleaned to lowercase for consistency</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">common_name_cleaned =</span> <span class="fu">str_to_lower</span>(common_name_cleaned))</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for SEA CRITTERS in Big Pine Key</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>sea_critters_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> corporate_name <span class="sc">==</span> <span class="st">"SEA CRITTERS"</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by species</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>species_summary <span class="ot">&lt;-</span> sea_critters_data <span class="sc">%&gt;%</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_adjusted_value))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if Snappers were ever landed</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>snappers_data <span class="ot">&lt;-</span> sea_critters_data <span class="sc">%&gt;%</span></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(common_name_cleaned <span class="sc">==</span> <span class="st">"Snappers"</span>)</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary data</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(species_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 2
   common_name_cleaned   total_adjusted_value
   &lt;chr&gt;                                &lt;dbl&gt;
 1 snail, star                         180405
 2 ricordea florida                    149411
 3 anemone, speckled                   134091
 4 crab, green clinging                103148
 5 hermit, tricolor                     88965
 6 corals                               82169
 7 turbinidae                           56461
 8 crabs, hermit                        28426
 9 stingrays                            21316
10 gorgonian, sea blades                17138
# ℹ 159 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(species_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(common_name_cleaned, total_adjusted_value), <span class="at">y =</span> total_adjusted_value)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">ifelse</span>(common_name_cleaned <span class="sc">==</span> <span class="st">"Snappers"</span>, <span class="st">"red"</span>, <span class="st">"grey"</span>))) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Species Landed by SEA CRITTERS in Big Pine Key Ordered by Adjusted Value"</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Adjusted Value"</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Species"</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"grey"</span> <span class="ot">=</span> <span class="st">"grey"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"snappers"</span> <span class="ot">=</span> <span class="st">"Snappers"</span>, <span class="st">"grey"</span> <span class="ot">=</span> <span class="st">"Other Species"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with NAs in relevant columns</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI <span class="sc">%&gt;%</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dealer_city) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(landed_year) <span class="sc">&amp;</span> </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(corporate_name) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(common_name_cleaned) <span class="sc">&amp;</span> </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(Adjusted_Val))</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert common_name_cleaned to lowercase for consistency</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">common_name_cleaned =</span> <span class="fu">str_to_lower</span>(common_name_cleaned))</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for SEA CRITTERS in Big Pine Key</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>sea_critters_data <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> corporate_name <span class="sc">==</span> <span class="st">"SEA CRITTERS"</span>)</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year and species</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>species_summary <span class="ot">&lt;-</span> sea_critters_data <span class="sc">%&gt;%</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year, common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(landed_year, <span class="fu">desc</span>(total_adjusted_value))</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank and filter to get top 5 species for each year</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>top_species <span class="ot">&lt;-</span> species_summary <span class="sc">%&gt;%</span></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(landed_year) <span class="sc">%&gt;%</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(landed_year, rank)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the top species summary table</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51 × 4
   landed_year common_name_cleaned  total_adjusted_value  rank
         &lt;int&gt; &lt;chr&gt;                               &lt;dbl&gt; &lt;int&gt;
 1        2004 snail, star                         20040     1
 2        2004 hermit, tricolor                     9868     2
 3        2004 crab, green clinging                 8119     3
 4        2004 rays                                 4937     4
 5        2004 stars, other sea                     4526     5
 6        2005 snail, star                        125517     1
 7        2005 hermit, tricolor                    13217     2
 8        2005 rays                                10605     3
 9        2005 crab, green clinging                 6398     4
10        2005 ricordea florida                     6236     5
# ℹ 41 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionally, save the table to a CSV file</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_species, <span class="st">"top_species_sea_critters.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert common_name_cleaned to lowercase for consistency</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>GI_cleaned <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">common_name_cleaned =</span> <span class="fu">str_to_lower</span>(common_name_cleaned))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for SEA CRITTERS in Big Pine Key for the year 2017</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>sea_critters_2017 <span class="ot">&lt;-</span> GI_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dealer_city <span class="sc">==</span> <span class="st">"BIG PINE KEY"</span> <span class="sc">&amp;</span> corporate_name <span class="sc">==</span> <span class="st">"SEA CRITTERS"</span> <span class="sc">&amp;</span> landed_year <span class="sc">==</span> <span class="dv">2017</span>)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by species</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>species_summary_2017 <span class="ot">&lt;-</span> sea_critters_2017 <span class="sc">%&gt;%</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(common_name_cleaned) <span class="sc">%&gt;%</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_adjusted_value =</span> <span class="fu">sum</span>(Adjusted_Val, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_adjusted_value))</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary data for 2017</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(species_summary_2017)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 65 × 2
   common_name_cleaned   total_adjusted_value
   &lt;chr&gt;                                &lt;dbl&gt;
 1 anemone, speckled                    26563
 2 ricordea florida                     20402
 3 crab, green clinging                 16000
 4 corals                               14161
 5 turbinidae                           13340
 6 hermit, tricolor                     12997
 7 crabs, hermit                         9300
 8 corallimorpharia                      5579
 9 cerithidea                            3178
10 gorgonian, sea blades                 2866
# ℹ 55 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(species_summary_2017, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(common_name_cleaned, total_adjusted_value), <span class="at">y =</span> total_adjusted_value)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Species Landed by SEA CRITTERS in Big Pine Key (2017)"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Adjusted Value"</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Disaster_Communities2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>